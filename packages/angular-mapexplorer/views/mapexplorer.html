<span class="error" ng-show="me.error">{{me.error}}</span>
<div class="segment-container" ng-show="me.segment" flex>
  <div class="title" layout="row">
    <div class="header">
      <h1>Segment</h1>
      <h2>{{me.segment.meta.linkHash}}</h2>
    </div>
    <span flex></span>
    <md-button class="md-icon-button" aria-label="Close" ng-click="me.close()">
      <md-icon md-font-library="material-icons">close</md-icon>
    </md-button>
  </div>
  <div layout="row" class="body">
    <div class="menu">
      <ul>
        <li ng-class="{ active: me.displayed == 'state'}" ng-click="me.display('state')">State</li>
        <li ng-class="{ active: me.displayed == 'link' }" ng-click="me.display('link')">Link</li>
        <li ng-class="{ active: me.displayed == 'evidence' }" ng-click="me.display('evidence')">Evidence</li>
        <li ng-class="{ active: me.displayed == 'json' }" ng-click="me.display('json')">JSON</li>
      </ul>
    </div>
    <div class="content" flex="grow">
      <div ng-show="me.displayed == 'state'" flex="grow">
        <div ui-ace="{
                            useWrapMode: true,
                            onLoad: me.aceLoaded
                        }" ng-model="me.state" readonly></div>
      </div>
      <div ng-show="me.displayed == 'link'" class="link">
        <h4>Map ID</h4>
        <p>{{me.segment.link.meta.mapId}}</p>

        <h4>Previous Link hash</h4>
        <p>{{me.segment.link.meta.prevLinkHash}}</p>

        <h4>Action</h4>
        <p>{{me.segment.link.meta.action}}({{me.segment.link.meta.inputs | functionArguments}})</p>

        <h4>Type</h4>
        <p>{{me.segment.link.meta.type}}</p>

        <h4>Signed by</h4>
        <p>
          {{ me.segment.link.signatures | signaturesList }}
        </p>

        <h4>Metadata</h4>
        <pre>{{ me.segment.link.meta.data | json }}</pre>
      </div>
      <div ng-show="me.displayed == 'evidence'" layout-gt-sm="row" layout="column">
        <st-evidences evidences="me.segment.meta.evidences"></st-evidences>
      </div>
      <div ng-show="me.displayed == 'json'">
        <div ui-ace="{
                            useWrapMode: true,
                            onLoad: me.aceLoaded
                        }" ng-model="me.segmentJSON" readonly></div>
      </div>
    </div>
  </div>
</div>
<div ng-show="me.loading" layout="row" layout-sm="column" layout-align="space-around">
  <md-progress-circular md-mode="indeterminate" md-diameter="80"></md-progress-circular>
</div>
<div ng-hide="me.loading" class="scroll">
  <div ng-show="tags && tags.length && options.showTagColorConfiguration" draggable id="tags-configuration">
    <md-toolbar>
      <div class="md-toolbar-tools">
        <h4>Configure link tag color</h4>
        <md-button class="md-icon-button" aria-label="Close" ng-click="options.showTagColorConfiguration = false">
          <md-icon md-font-library="material-icons">close</md-icon>
        </md-button>
      </div>
    </md-toolbar>
    <div class="content">
      <st-tag-color-picker ng-repeat="tag in tags" tag="tag"></st-tag-color-picker>
    </div>
  </div>
</div>
